generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["multiSchema"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["public"]
}

model dental_groups {
  dental_group_id      BigInt             @id
  name                 String
  dental_group_sfdc_id String?
  is_active            Boolean?           @default(true)
  created_at           DateTime?          @default(now()) @db.Timestamp(6)
  updated_at           DateTime?          @default(now()) @db.Timestamp(6)
  address              String?
  address_2            String?
  city                 String?
  state                String?
  zip                  String?
  account_type         String?
  centralized_billing  Boolean?
  sales_channel        String?
  sales_rep            String?
  dental_practices     dental_practices[]

  @@index([dental_group_sfdc_id], map: "idx_dental_groups_sfdc_id")
  @@schema("public")
}

model dental_practices {
  practice_id              BigInt                 @id
  dental_group_id          BigInt?
  dental_group_name        String?
  address                  String?
  address_2                String?
  city                     String?
  state                    String?
  zip                      String?
  phone                    String?
  clinical_email           String?
  billing_email            String?
  incisive_email           String?
  preferred_contact_method String?
  fee_schedule             String?
  status                   String?
  is_active                Boolean?               @default(true)
  created_at               DateTime?              @default(now()) @db.Timestamp(6)
  updated_at               DateTime?              @default(now()) @db.Timestamp(6)
  dental_groups            dental_groups?         @relation(fields: [dental_group_id], references: [dental_group_id], onDelete: NoAction, onUpdate: NoAction)
  fee_schedules            fee_schedules?         @relation(fields: [fee_schedule], references: [schedule_name], onDelete: NoAction, onUpdate: NoAction, map: "fk_dental_practices_fee_schedule")
  lab_practice_mapping     lab_practice_mapping[]
  orders_current           orders_current[]       @ignore

  @@index([dental_group_id], map: "idx_dental_practices_group_id")
  @@schema("public")
}

model fee_schedules {
  schedule_name         String                  @id
  dental_practices      dental_practices[]
  product_lab_rev_share product_lab_rev_share[]

  @@schema("public")
}

model incisive_product_catalog {
  incisive_id           Int                     @id
  incisive_name         String
  category              String?
  sub_category          String?
  is_active             Boolean?                @default(true)
  created_at            DateTime?               @default(now()) @db.Timestamp(6)
  updated_at            DateTime?               @default(now()) @db.Timestamp(6)
  lab_product_mapping   lab_product_mapping[]
  orders_current        orders_current[]        @ignore
  product_lab_markup    product_lab_markup[]
  product_lab_rev_share product_lab_rev_share[]

  @@index([category], map: "idx_product_catalog_category")
  @@schema("public")
}

model lab_practice_mapping {
  lab_practice_mapping_id BigInt           @id @default(autoincrement())
  lab_id                  BigInt
  practice_id             BigInt
  lab_practice_id         String?
  is_active               Boolean?         @default(true)
  created_at              DateTime?        @default(now()) @db.Timestamp(6)
  updated_at              DateTime?        @default(now()) @db.Timestamp(6)
  labs                    labs      @relation(fields: [lab_id], references: [lab_id], onDelete: NoAction, onUpdate: NoAction)
  dental_practices        dental_practices @relation(fields: [practice_id], references: [practice_id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([lab_id, lab_practice_id])
  @@index([lab_id], map: "idx_lab_practice_mapping_lab_id")
  @@index([practice_id], map: "idx_lab_practice_mapping_practice_id")
  @@schema("public")
}

model lab_product_mapping {
  lab_product_mapping_id   BigInt                    @id @default(autoincrement())
  lab_id                   BigInt
  lab_product_id           String?
  lab_product_name         String?
  incisive_product_id      Int?
  is_active                Boolean?                  @default(true)
  created_at               DateTime?                 @default(now()) @db.Timestamp(6)
  updated_at               DateTime?                 @default(now()) @db.Timestamp(6)
  incisive_product_catalog incisive_product_catalog? @relation(fields: [incisive_product_id], references: [incisive_id], onDelete: NoAction, onUpdate: NoAction)
  labs                     labs               @relation(fields: [lab_id], references: [lab_id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([lab_id, lab_product_id], map: "lab_product_mapping_lab_id_product_id_key")
  @@index([incisive_product_id], map: "idx_lab_product_mapping_incisive_id")
  @@index([lab_id], map: "idx_lab_product_mapping_lab_id")
  @@schema("public")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model orders_current {
  caseid                   BigInt
  productid                String
  submissiondate           String?
  shippingdate             String?
  casedate                 String?
  productdescription       String?
  quantity                 BigInt?
  productprice             String?
  patientname              String?
  customerid               String?
  customername             String?
  address                  String?
  phonenumber              String?
  casestatus               String?
  holdreason               String?
  estimatecompletedate     String?
  requestedreturndate      String?
  trackingnumber           String?
  estimatedshipdate        String?
  holddate                 String?
  deliverystatus           String?
  notes                    String?
  onhold                   String?
  shade                    String?
  mold                     String?
  doctorpreferences        String?
  productpreferences       String?
  comments                 String?
  casetotal                String?
  lab_id                   BigInt?
  incisive_product_id      Int?
  incisive_practice_id     BigInt?
  row_hash                 String?
  last_updated_at          DateTime?                 @default(now()) @db.Timestamp(6)
  dental_practices         dental_practices?         @relation(fields: [incisive_practice_id], references: [practice_id], onDelete: NoAction, onUpdate: NoAction)
  incisive_product_catalog incisive_product_catalog? @relation(fields: [incisive_product_id], references: [incisive_id], onDelete: NoAction, onUpdate: NoAction)

  @@ignore
  @@schema("public")
}

/// This table is managed by ETL and should not be accessed via Prisma Client.
model orders_history {
  history_id      BigInt    @id @default(autoincrement())
  caseid          BigInt?
  productid       String?
  lab_id          BigInt?
  change_type     String?
  changed_columns String[]
  old_row         Json?
  new_row         Json?
  source_file_key String?
  changed_at      DateTime? @default(now()) @db.Timestamp(6)

  @@ignore
  @@index([caseid, productid], map: "idx_orders_history_caseid_productid")
  @@schema("public")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model orders_stage {
  submissiondate       String?
  shippingdate         String?
  casedate             String?
  caseid               BigInt?
  productid            String?
  productdescription   String?
  quantity             BigInt?
  productprice         String?
  patientname          String?
  customerid           String?
  customername         String?
  address              String?
  phonenumber          String?
  casestatus           String?
  holdreason           String?
  estimatecompletedate String?
  requestedreturndate  String?
  trackingnumber       String?
  estimatedshipdate    String?
  holddate             String?
  deliverystatus       String?
  notes                String?
  onhold               String?
  shade                String?
  mold                 String?
  doctorpreferences    String?
  productpreferences   String?
  comments             String?
  casetotal            String?
  lab_id               BigInt?   @default(2)
  source_file_key      String?
  row_hash             String?
  loaded_at            DateTime? @default(now()) @db.Timestamp(6)

  @@ignore
  @@schema("public")
}

model patients {
  patient_name String @id

  @@schema("public")
}

enum user_role {
  ADMIN
  USER
  VIEWER

  @@schema("public")
}

model users {
  id            String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  email         String    @unique
  password      String
  first_name    String?
  last_name     String?
  role          user_role @default(USER)
  is_active     Boolean   @default(true)
  refresh_token String?
  created_at    DateTime  @default(now()) @db.Timestamp(6)
  updated_at    DateTime  @updatedAt @db.Timestamp(6)

  @@schema("public")
}

model product_lab_markup {
  lab_id                   BigInt
  lab_product_id           String
  incisive_product_id      Int?
  cost                     Float?
  standard_price           Float?
  nf_price                 Float?
  commitment_eligible      Boolean?
  incisive_product_catalog incisive_product_catalog? @relation(fields: [incisive_product_id], references: [incisive_id], onDelete: NoAction, onUpdate: NoAction)
  labs                     labs               @relation(fields: [lab_id], references: [lab_id], onDelete: NoAction, onUpdate: NoAction)

  @@id([lab_id, lab_product_id])
  @@schema("public")
}

model product_lab_rev_share {
  lab_id                   BigInt
  lab_product_id           String
  incisive_product_id      Int?
  fee_schedule_name        String
  revenue_share            Float?
  commitment_eligible      Boolean?
  fee_schedules            fee_schedules             @relation(fields: [fee_schedule_name], references: [schedule_name], onDelete: NoAction, onUpdate: NoAction)
  incisive_product_catalog incisive_product_catalog? @relation(fields: [incisive_product_id], references: [incisive_id], onDelete: NoAction, onUpdate: NoAction)
  labs                     labs               @relation(fields: [lab_id], references: [lab_id], onDelete: NoAction, onUpdate: NoAction)

  @@id([lab_id, lab_product_id, fee_schedule_name])
  @@schema("public")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model labs {
  lab_id                BigInt                  @id @default(autoincrement())
  lab_name              String
  lab_sfdc_id           String?
  partner_model         String?
  is_active             Boolean?                @default(true)
  created_at            DateTime?               @default(now()) @db.Timestamp(6)
  updated_at            DateTime?               @default(now()) @db.Timestamp(6)
  lab_practice_mapping  lab_practice_mapping[]
  lab_product_mapping   lab_product_mapping[]
  product_lab_markup    product_lab_markup[]
  product_lab_rev_share product_lab_rev_share[]

  @@index([lab_sfdc_id], map: "idx_labs_sfdc_id")
  @@schema("public")
}
